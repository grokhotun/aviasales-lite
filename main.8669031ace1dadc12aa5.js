!function(e){function t(t){for(var r,o,i=t[0],s=t[1],l=t[2],f=0,m=[];f<i.length;f++)o=i[f],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&m.push(a[o][0]),a[o]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);for(u&&u(t);m.length;)m.shift()();return c.push.apply(c,l||[]),n()}function n(){for(var e,t=0;t<c.length;t++){for(var n=c[t],r=!0,i=1;i<n.length;i++){var s=n[i];0!==a[s]&&(r=!1)}r&&(c.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},a={0:0},c=[];function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="./";var i=window.webpackJsonp=window.webpackJsonp||[],s=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var u=s;c.push([139,1]),n()}({139:function(e,t,n){n(140),e.exports=n(343)},334:function(e,t,n){},335:function(e,t,n){},336:function(e,t,n){},337:function(e,t,n){},338:function(e,t,n){},339:function(e,t,n){},341:function(e,t,n){},343:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(64),o=n.n(c),i=n(138),s=n(29),l=n.p+"8bb77c6b0005cc90fc066a368eb7451a.svg",u=(n(334),function(){return a.a.createElement("header",{className:"header"},a.a.createElement("div",{className:"header__logo"},a.a.createElement("img",{src:l,alt:"Лого приложения"})))}),f=(n(335),function(){return a.a.createElement("div",{className:"spinner"},a.a.createElement("div",{className:"lds-ring"},a.a.createElement("div",null),a.a.createElement("div",null),a.a.createElement("div",null),a.a.createElement("div",null)))}),m=(n(336),function(){return a.a.createElement("div",{className:"error-indicator"},a.a.createElement("div",{className:"error-indicator__text"},a.a.createElement("p",null,"Извините, но что-то пошло не так."),a.a.createElement("p",null,"Скоро исправим")))});function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e,t){return!t||"object"!==p(t)&&"function"!=typeof t?g(e):t}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var w=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(i,e);var t,n,r,c,o=(t=i,function(){var e,n=_(t);if(y()){var r=_(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return v(this,e)});function i(){var e;d(this,i);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return E(g(e=o.call.apply(o,[this].concat(n))),"state",{hasError:!1}),e}return n=i,(r=[{key:"componentDidCatch",value:function(){this.setState({hasError:!0})}},{key:"render",value:function(){return this.state.hasError?a.a.createElement(m,null):this.props.children}}])&&b(n.prototype,r),c&&b(n,c),i}(r.Component),k=(n(337),function(e){var t=e.ticket,n=t.carrier,r=t.price,c=t.to,o=t.from;return a.a.createElement("div",{className:"ticket-card"},a.a.createElement("div",{className:"ticket-card__header"},a.a.createElement("div",{className:"ticket-card__price"},"".concat(r," р.")),a.a.createElement("div",{className:"ticket-card__logo"},a.a.createElement("img",{src:"http://pics.avs.io/99/36/".concat(n,".png"),alt:"Лого авиакомпании"}))),a.a.createElement("div",{className:"ticket-card__body"},a.a.createElement("div",{className:"ticket-card__row row-ticket-card"},a.a.createElement("div",{className:"row-ticket-card__col"},a.a.createElement("div",{className:"row-ticket-card__name"},c.direction),a.a.createElement("div",{className:"row-ticket-card__value"},c.timeInterval)),a.a.createElement("div",{className:"row-ticket-card__col"},a.a.createElement("div",{className:"row-ticket-card__name"},"В ПУТИ"),a.a.createElement("div",{className:"row-ticket-card__value"},c.duration)),a.a.createElement("div",{className:"row-ticket-card__col"},a.a.createElement("div",{className:"row-ticket-card__name"},0===c.stops.length?"прямой":c.stops.length>1?"".concat(c.stops.length," пересадки"):"".concat(c.stops.length," пересадка")),a.a.createElement("div",{className:"row-ticket-card__value"},0===c.stops.length?" ":c.stops.map((function(e,t){return t>=1?", ".concat(e):e}))))),a.a.createElement("div",{className:"ticket-card__row row-ticket-card"},a.a.createElement("div",{className:"row-ticket-card__col"},a.a.createElement("div",{className:"row-ticket-card__name"},o.direction),a.a.createElement("div",{className:"row-ticket-card__value"},o.timeInterval)),a.a.createElement("div",{className:"row-ticket-card__col"},a.a.createElement("div",{className:"row-ticket-card__name"},"В ПУТИ"),a.a.createElement("div",{className:"row-ticket-card__value"},o.duration)),a.a.createElement("div",{className:"row-ticket-card__col"},a.a.createElement("div",{className:"row-ticket-card__name"},0===o.stops.length?"прямой":o.stops.length>1?"".concat(o.stops.length," пересадки"):"".concat(o.stops.length," пересадка")),a.a.createElement("div",{className:"row-ticket-card__value"},0===o.stops.length?" ":o.stops.map((function(e,t){return t>=1?", "+e:e})))))))}),T=(n(338),function(e){var t=e.name,n=e.label,r=e.checked,c=e.onToggle;return a.a.createElement("label",{htmlFor:t,className:"checkbox"},a.a.createElement("input",{onChange:function(){return c(t,r)},checked:r,id:t,type:"checkbox",className:"checkbox__input"}),a.a.createElement("span",{className:"checkbox__custom"}),a.a.createElement("span",{className:"checkbox__text"},n))}),O=function(e){var t=e.onToggle,n=e.transitions;return a.a.createElement("div",{className:"filter"},a.a.createElement("div",{className:"filter__header"},a.a.createElement("div",{className:"filter__title"},"Количество пересадок")),a.a.createElement("div",{className:"filter__body"},a.a.createElement(T,{onToggle:t,checked:n.all,label:"Все",name:"all"}),a.a.createElement(T,{onToggle:t,checked:n.straight,label:"Прямой",name:"straight"}),a.a.createElement(T,{onToggle:t,checked:n.oneTransition,label:"1 пересадка",name:"oneTransition"}),a.a.createElement(T,{onToggle:t,checked:n.twoTransition,label:"2 пересадки",name:"twoTransition"}),a.a.createElement(T,{onToggle:t,checked:n.threeTransition,label:"3 пересадки",name:"threeTransition"})))},N=n(98),j=n.n(N),S=(n(339),function(e){var t=e.filterBy,n=e.setFilter;return a.a.createElement("div",{className:"tabs"},a.a.createElement("button",{onClick:function(){return n("fast")},className:j()("tabs__btn tabs__btn--left",{"is-active":"fast"===t})},"Самый быстрый"),a.a.createElement("button",{onClick:function(){return n("cheap")},className:j()("tabs__btn tabs__btn--right",{"is-active":"cheap"===t})},"Самый дешевый"))}),P=function(e){var t=e.tickets,n=e.showMoreTickets,r=e.shownTickets;return a.a.createElement("div",{className:"tickets"},a.a.createElement("div",{className:"tickets__body"},0===t.length?a.a.createElement("div",{className:"tickets__not-found"},a.a.createElement("span",null,"Не найдено билетов с даннными параметрами")):t.map((function(e,t){return a.a.createElement(k,{key:t,ticket:e})}))),a.a.createElement("div",{className:"tickets__footer"},r>t.length?null:a.a.createElement("button",{onClick:function(){return n()},className:"tickets__showmore-btn"},"Показать ещё 5 вариантов")))};function x(e,t,n,r,a,c,o){try{var i=e[c](o),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(r,a)}function I(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var c=e.apply(t,n);function o(e){x(c,r,a,o,i,"next",e)}function i(e){x(c,r,a,o,i,"throw",e)}o(void 0)}))}}function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var R=function(e){var t=60*e,n=Math.floor(t/60/60),r=Math.floor(t/60)-60*n;return"".concat(n," ч. ").concat(r," м.")},D=function(e,t){var n=new Date(e),r=new Date,a=n.getTime()+6e4*t;r.setTime(a);var c="".concat(n.getHours()<10?"0":"").concat(n.getHours(),":").concat(n.getMinutes()<10?"0":"").concat(n.getMinutes()),o="".concat(r.getHours()<10?"0":"").concat(r.getHours(),":").concat(r.getMinutes()<10?"0":"").concat(r.getMinutes());return"".concat(c," - ").concat(o)},B=new function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),C(this,"_apiBase1","http://localhost:3000"),C(this,"_apiBase2","https://front-test.beta.aviasales.ru"),C(this,"getResource",function(){var e=I(regeneratorRuntime.mark((function e(n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(t._apiBase2).concat(n));case 2:if((r=e.sent).ok){e.next=5;break}throw new Error("Could not fetch ".concat(n)+", received ".concat(r.status));case 5:return e.next=7,r.json();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),C(this,"getSearchId",I(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getResource("/search");case 2:return n=e.sent,r=n.searchId,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))),C(this,"getData",I(regeneratorRuntime.mark((function e(){var n,r,a,c,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getSearchId();case 2:return n=e.sent,r=[],e.next=6,fetch("https://front-test.beta.aviasales.ru/tickets?searchId=".concat(n));case 6:return a=e.sent,e.next=9,a.json();case 9:c=e.sent,r=r.concat(c.tickets);case 11:if(a.stop){e.next=31;break}return e.prev=12,e.next=15,fetch("https://front-test.beta.aviasales.ru/tickets?searchId=".concat(n));case 15:return o=e.sent,e.next=18,o.json();case 18:i=e.sent,r=r.concat(i.tickets),e.next=29;break;case 22:if(e.prev=22,e.t0=e.catch(12),500!==a.status){e.next=28;break}console.log("Повторяю запрос"),e.next=29;break;case 28:return e.abrupt("break",31);case 29:e.next=11;break;case 31:return e.abrupt("return",r.map((function(e){return{carrier:e.carrier,price:e.price,totalDuration:e.segments[0].duration+e.segments[1].duration,totalTransitions:e.segments[0].stops.length+e.segments[1].stops.length,to:{timeInterval:D(e.segments[0].date,e.segments[0].duration),duration:R(e.segments[0].duration),stops:e.segments[0].stops,direction:"".concat(e.segments[0].origin," - ").concat(e.segments[0].destination)},from:{timeInterval:D(e.segments[1].date,e.segments[1].duration),duration:R(e.segments[1].duration),stops:e.segments[1].stops,direction:"".concat(e.segments[1].destination," - ").concat(e.segments[1].origin)}}})));case 32:case"end":return e.stop()}}),e,null,[[12,22]])}))))},F=function(e){return function(){e({type:"FETCH_TICKETS_REQUEST"}),B.getData().then((function(t){return e({type:"FETCH_TICKETS_SUCCESS",payload:t})})).catch((function(t){return e(function(e){return{type:"FETCH_TICKETS_FAILED",payload:e}}(t))}))}},M=n(99),A=function(e,t){switch(t){case"fast":return Object(M.orderBy)(e,"totalDuration","asc");case"cheap":return Object(M.orderBy)(e,"price","asc");default:return e}},H=function(e,t){return e.filter((function(e){return t.all||t.straight&&0===e.totalTransitions||t.oneTransition&&1===e.totalTransitions||t.twoTransition&&2===e.totalTransitions||t.threeTransition&&3===e.totalTransitions}))};function K(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(r=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,c=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return L(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return L(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var U=Object(s.b)((function(e){var t=e.tickets,n=e.error,r=e.loading,a=e.filterBy,c=e.transitions;return{tickets:A(H(t,c),a),error:n,loading:r,filterBy:a}}),(function(e){return{fetchTickets:F(e)}}))((function(e){var t=e.tickets,n=e.error,c=e.loading,o=e.fetchTickets,i=K(Object(r.useState)(5),2),s=i[0],l=i[1];Object(r.useEffect)((function(){o()}),[]);return c?a.a.createElement(f,null):n?a.a.createElement(m,null):a.a.createElement(P,{tickets:t.slice(0,s),shownTickets:s,showMoreTickets:function(){l(s+5)}})})),J=Object(s.b)((function(e){return{filterBy:e.filterBy}}),(function(e){return{setFilterBy:function(t){return e({type:"SET_FILTER_BY",payload:t})}}}))((function(e){var t=e.filterBy,n=e.setFilterBy;return a.a.createElement(S,{setFilter:n,filterBy:t})}));function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var q=Object(s.b)((function(e){return{transitions:e.transitions}}),(function(e){return{setTransitions:function(t){return e(function(e){return{type:"SET_TRANSITIONS_FILTER",payload:e}}(t))}}}))((function(e){var t=e.transitions,n=e.setTransitions;return a.a.createElement(O,{transitions:t,onToggle:function(e){"all"===e?t.all?n({all:!1,straight:!1,oneTransition:!1,twoTransition:!1,threeTransition:!1}):n({all:!0,straight:!0,oneTransition:!0,twoTransition:!0,threeTransition:!0}):n(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach((function(t){Y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t,Y({},e,!t[e])))}})})),$=function(){return a.a.createElement("div",{className:"wrapper"},a.a.createElement("div",{className:"container"},a.a.createElement("div",{className:"content"},a.a.createElement("div",{className:"content__header"},a.a.createElement(u,null)),a.a.createElement("div",{className:"content__body"},a.a.createElement("aside",{className:"content__aside"},a.a.createElement(q,null)),a.a.createElement("main",{className:"content__main"},a.a.createElement(J,null),a.a.createElement(U,null))),a.a.createElement("div",{className:"content__footer"}))))},z=n(66);function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(Object(n),!0).forEach((function(t){W(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function W(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var X={tickets:[],loading:!0,error:!1,filterBy:"fast",transitions:{all:!0,straight:!0,oneTransition:!0,twoTransition:!0,threeTransition:!0}},Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_TICKETS_REQUEST":return V({},e,{tickets:[],loading:!0,error:!1});case"FETCH_TICKETS_SUCCESS":return V({},e,{tickets:t.payload,loading:!1,error:!1});case"FETCH_TICKETS_FAILED":return V({},e,{tickets:[],loading:!1,error:!0});case"SET_TRANSITIONS_FILTER":return V({},e,{transitions:t.payload});case"SET_FILTER_BY":return V({},e,{filterBy:t.payload});default:return e}},ee=Object(z.b)(Z);n(341);o.a.render(a.a.createElement(s.a,{store:ee},a.a.createElement(i.a,null,a.a.createElement(w,null,a.a.createElement($,null)))),document.querySelector("#root"))}});